# MIDIFramework用サンプルプロジェクト

## MIDIFrameworkについて
MIDIFrameworkでは
- MIDI送信
- MIDI受信
- MIDI処理に関連した便利機能の提供
  
ができます。  
これらの機能をソースコードではなく、Frameworkとして提供しています。  
サンプルプロジェクト内のFrameworkをコピーして、ご自身のプロジェクトに組み込むことができます。  

Frameworkのアップデートがある場合は、このサンプルプロジェクトを更新します。  
サンプルプロジェクトからFrameworkを再度コピーしてお使いください。

## MIDI受信方法
### Notificationを使用(一番手軽)
サンプルプロジェクトはこの方式で作られています。  
このサンプルプロジェクトでは、Macに接続されたMIDIデバイスのリスト上最初のデバイスでインスタンスを生成します。  
インスタンスを生成すると、すぐに受信可能な状態になります。  
MIDIメッセージはNotificationで通知されます。  

Notificationの種類はいくつかあり、  
- すべてのメッセージの受信通知
- システムエクスクルーシブメッセージの受信通知
- ノートオン/オフを受信した受信通知
- ポリフォニックアフタータッチの受信通知
- チャンネルアフタータッチの受信通知
- コントロールチェンジの受信通知
- ピッチベンドの受信通知
- アクティブセンシングの受信通知

があります。  
すべてのメッセージの受信通知を使う場合は、受信した際に自身でメッセージの内容を判断して処理します。  
特定の受信通知を使えば、メッセージ内容の判断処理を軽減できます。  
例えば、受信したデータを鍵盤上で表示する様なアプリの場合、ノートオン/オフの受信通知を使うと便利です。 　

### LMIDIクラスのサブクラスを生成する
MIDIデータ受信のタイミングでサブクラスのデリゲートメソッドが呼び出されます。  
サブクラスにプロトコル```LMIDIDelegate```を適用します。  
プロトコルを適用すると、
```
func messageReceived(receiveData: Data, MIDITimeStamp: MIDITimeStamp)
```
を実装するようXcodeが通知を出しますので、それに従って実装します。  
引数の中に受信したデータとタイムスタンプが格納されています。  
MIDIレコーダーの様なアプリケーションに向いています。

## MIDI送信方法
送信のタイミングを決める方法が二つあり、
- 即座に送信する
- タイムスタンプを付けて送信する

が選べます。  
インスタンスメソッドはいずれも```send```ですが、引数にタイムスタンプがあるメソッドは、指定したタイムスタンプで送信します。  
引数にタイムスタンプのないメソッドは即座に送信します。  
送るデータは```Data型```で作ってメソッドに渡します。  
データはMIDIのデータそのものをData型にします。  
例えば、ノートオンの```90 3C 64```というデータを送信したい場合、生成するData型の引数は下記の通りです。
```
let pkt = Data([0x90, 0x3c, 0x64])

midiInstance.send(packet: pkt)
```
ノートオンだけでなく、すべてのMIDIメッセージをsendメソッドで送信できます。

## 便利機能
1. オールノートオフ、オールサウンドオフなどのコントロール送信
2. 7bit, 8bitデータの相互変換

